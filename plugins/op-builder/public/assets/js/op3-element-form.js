!function(t,e,a){"use strict";var i=function(e){if(function(){var e=!1,a=t(this).find("input.op3-element-input-edit-text");return a.parent(".op3-element-input-edit").siblings(".op3-element-input-edit-error").remove(),a.each(function(a,i){var o=t(i);if("text"===o.attr("type")&&o.attr("required")&&""===o.val()||"checkbox"===o.attr("type")&&o.attr("required")&&!o.is(":checked")){var n=o.attr("data-op3-validation-message")||o.attr("data-op-validation-message");o.closest(".op3-element-input-wrapper").append('<p class="op3-element-input-edit-error">'+n+"</p>"),e=!0}}),e}.call(this))e.preventDefault();else{if(this.checkValidity()){var a=t(this).find("[name]:not(:disabled)").attr("disabled","disabled"),i=function(){var e={};return t(this).each(function(){var a=t(this).attr("name");if("op3-dummy"!==a&&"optin-gdpr-activate"!==a&&!/^optin-post-action/.test(a)){var i=t(this).val();if("checkbox"===t(this).attr("type")){var o=t(this).is(":checked"),n=t(this).is(":visible");!o&&n?i=!1:o||n||(i=null)}e[a]=i,"optin-gdpr-consent-1"===a&&(e["optin-gdpr-message-1"]=t(this).closest("label").text()),"optin-gdpr-consent-2"===a&&(e["optin-gdpr-message-2"]=t(this).closest("label").text())}}),e["optin-button-message"]=t(this).closest("form").find('.op3-element[data-op3-element-type="button"] .op3-text-container').text(),e}.call(a);t(this).find('[data-op3-element-type="button"] a').removeAttr("href").blur(),t.ajax({url:t(this).attr("action"),type:"post",data:i,success:n.bind(a),error:r.bind(a),beforeSend:s.bind(this)})}else t(this).find('[type="submit"]').click();e.preventDefault()}},o=function(e){t(this).attr("href")&&t(this).closest("form").submit(),e.preventDefault()},n=function(a,i,o){var n={},r="";t(this).each(function(){var e=t(this);n[e.attr("name")]=e.val();var a="";a=e.data("op-url-mapping")?e.data("op-url-mapping")?e.data("op-url-mapping"):e.attr("name"):e.data("op3-url-mapping")?e.data("op3-url-mapping"):e.attr("name"),e.is(":visible")&&(r+="&"+a+"="+encodeURIComponent(e.val()))});var s=t(this.context).find('.op3-element[data-op3-element-type="button"]');if(p(s),t(this.context).closest(".op3-element ").find(".op3-form-notification").remove(),"notification"===n["optin-post-action"]&&n["optin-post-action-notification-text"]){var c=t(this).parent("form");t("<div />").text(n["optin-post-action-notification-text"]).addClass("op3-form-notification").insertBefore(c),c.remove()}else if("redirect"===n["optin-post-action"]&&n["optin-post-action-redirect-url"]){var l=n["optin-post-action-redirect-url"];1*n["optin-post-action-redirect-autofill"]&&(l+=l.split("?").length>1?"&":"?",l+=r.substring(1)),e.location.href=l}else if("popoverlay"===n["optin-post-action"]){var d=n["optin-post-action-popoverlay-trigger"];t(this).closest(".op3-popoverlay-wrapper").find(".op3-popoverlay-close").trigger("click"),OP3.PopOverlay.open(d)}else if("hidePopoverlay"===n["optin-post-action"])t(this).closest(".op3-popoverlay-wrapper").find(".op3-popoverlay-close").trigger("click");else if("nextFunnelStep"===n["optin-post-action"]){(f=!!(a&&a.data&&a.data.redirect_url)&&a.data.redirect_url)&&(e.location.href=f)}else if("goToFunnelStep"===n["optin-post-action"]){var f;(f=!!(a&&a.data&&a.data.redirect_url)&&a.data.redirect_url)&&(e.location.href=f)}},r=function(e,a,i){var o={},n=e.status;t(this).each(function(){var e=t(this);o[e.attr("name")]=e.val();var a="";a=e.data("op-url-mapping")?e.data("op-url-mapping")?e.data("op-url-mapping"):e.attr("name"):e.data("op3-url-mapping")?e.data("op3-url-mapping"):e.attr("name"),e.is(":visible")&&"&"+a+"="+encodeURIComponent(e.val())});var r=t(this).parent("form"),s=t("<div />"),c=t(this.context).find('.op3-element[data-op3-element-type="button"]'),l=e.responseJSON,d="Something went wrong.";p(c),t(this.context).closest(".op3-element ").find(".op3-form-notification").remove(),409==n?(d=l&&l.message?l.message:"You are already subscribed.",s.text(d).addClass("op3-form-notification").addClass("warning-notification")):401==n||403==n?(d="API authorization error.",s.text(d).addClass("op3-form-notification").addClass("error-notification")):(d=l&&l.message?l.message:"Something went wrong.",s.text(d).addClass("op3-form-notification").addClass("error-notification")),s.insertBefore(r).animate({left:"-4px"},120).animate({left:"4px"},120).animate({left:"-4px"},120).animate({left:"4px"},120).animate({left:"0px"},120),r.find("[name]:disabled").removeAttr("disabled"),r.find('[data-op3-element-type="button"] a').attr("href","#").focus()},p=function(t){t.find('[data-op3-background="overlay"]').css("opacity",""),t.find(".submitting").remove(),t.find(".op3-text-container, .op3-subtext").css("display","")},s=function(){var e=t(this);e.find('[data-op3-background="overlay"]').css("opacity",.65),e.find(".op3-text-container, .op3-subtext").css("display","none"),e.find("a").append('<div class="submitting"></div>')};e.op3GrecaptchaInit=function(){var e=OP3.GoogleRecaptcha.googleRecaptchaSiteKey;e&&t('[data-op3-element-type="form"] form').each(function(){var a=t(this);grecaptcha.ready(function(){grecaptcha.execute(e,{action:"op3optin"}).then(function(e){t("<input>").attr({type:"hidden",name:"op3-grecaptcha-token",value:e}).appendTo(a);var i=t(".grecaptcha-badge");i.show(),i.css("visibility","visible")})})})},t(function(){var e=OP3.GoogleRecaptcha.googleRecaptchaSiteKey;if(e&&"undefined"==typeof grecaptcha){var n=a.getElementsByTagName("script")[0],r=a.createElement("script");r.async=!0,r.src="https://www.google.com/recaptcha/api.js?onload=op3GrecaptchaInit&render="+e,n.parentNode.insertBefore(r,n)}else op3GrecaptchaInit();t('[data-op3-element-type="form"] form').each(function(){t(this).on("submit",i).find('[data-op3-element-type="button"] a').on("click",o)})})}(jQuery,window,document);